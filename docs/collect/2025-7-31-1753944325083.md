---
title: çº¯æµè§ˆå™¨ç«¯Excelå›¾ç‰‡å¤„ç†
date: 2025-7-31
categories:

tags:
 - excelize-wasm
---

# Excelå›¾ç‰‡å¤„ç†å·¥å…·

## ğŸ“‹ é¡¹ç›®ç®€ä»‹

è¿™æ˜¯ä¸€ä¸ªåŸºäºWebçš„Excelå›¾ç‰‡å¤„ç†å·¥å…·ï¼Œèƒ½å¤Ÿè‡ªåŠ¨æå–Excelæ–‡ä»¶ä¸­çš„å›¾ç‰‡ï¼Œæ¨¡æ‹Ÿä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œå¹¶åœ¨åŸä½ç½®è®¾ç½®è¶…é“¾æ¥ã€‚è¯¥å·¥å…·ä½¿ç”¨çº¯å‰ç«¯æŠ€æœ¯å®ç°ï¼Œæ— éœ€æœåŠ¡å™¨ç«¯æ”¯æŒã€‚

## âœ¨ ä¸»è¦åŠŸèƒ½

- **ğŸ“ æ–‡ä»¶ä¸Šä¼ **: æ”¯æŒæ‹–æ‹½å’Œç‚¹å‡»ä¸Šä¼ Excelæ–‡ä»¶ï¼ˆ.xlsx, .xlsæ ¼å¼ï¼‰
- **ğŸ–¼ï¸ å›¾ç‰‡æå–**: è‡ªåŠ¨è¯†åˆ«å¹¶æå–Excelä¸­çš„å›¾ç‰‡
- **â˜ï¸ å›¾ç‰‡ä¸Šä¼ **: æ¨¡æ‹Ÿå›¾ç‰‡ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼ˆå¯æ›¿æ¢ä¸ºçœŸå®ä¸Šä¼ é€»è¾‘ï¼‰
- **ğŸ”— è¶…é“¾æ¥è®¾ç½®**: å°†å›¾ç‰‡æ›¿æ¢ä¸ºè¶…é“¾æ¥æ–‡æœ¬
- **ğŸ“Š è¿›åº¦æ˜¾ç¤º**: å®æ—¶æ˜¾ç¤ºå¤„ç†è¿›åº¦å’ŒçŠ¶æ€
- **ğŸ’¾ æ–‡ä»¶ä¸‹è½½**: è‡ªåŠ¨ç”Ÿæˆå¤„ç†åçš„Excelæ–‡ä»¶ä¾›ä¸‹è½½

## ğŸ¯ æŠ€æœ¯ç‰¹æ€§

- **çº¯å‰ç«¯å®ç°**: ä½¿ç”¨HTML5 + CSS3 + JavaScript
- **Excelå¤„ç†**: åŸºäºexcelize-wasmåº“è¿›è¡ŒExcelæ–‡ä»¶æ“ä½œ
- **å“åº”å¼è®¾è®¡**: ç°ä»£åŒ–çš„UIç•Œé¢ï¼Œæ”¯æŒå„ç§è®¾å¤‡
- **æ‹–æ‹½ä¸Šä¼ **: æ”¯æŒæ–‡ä»¶æ‹–æ‹½ä¸Šä¼ åŠŸèƒ½
- **å®æ—¶åé¦ˆ**: è¯¦ç»†çš„å¤„ç†çŠ¶æ€å’Œè¿›åº¦æ˜¾ç¤º

## ğŸš€ ä½¿ç”¨æ–¹æ³•

1. **æ‰“å¼€å·¥å…·**: åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€index.htmlæ–‡ä»¶
2. **ä¸Šä¼ æ–‡ä»¶**: ç‚¹å‡»ä¸Šä¼ åŒºåŸŸæˆ–æ‹–æ‹½Excelæ–‡ä»¶åˆ°æŒ‡å®šåŒºåŸŸ
3. **ç­‰å¾…å¤„ç†**: ç³»ç»Ÿä¼šè‡ªåŠ¨å¤„ç†æ–‡ä»¶ï¼Œæ˜¾ç¤ºå®æ—¶è¿›åº¦
4. **ä¸‹è½½ç»“æœ**: å¤„ç†å®Œæˆåç‚¹å‡»ä¸‹è½½æŒ‰é’®è·å–ç»“æœæ–‡ä»¶

## ğŸ“ é¡¹ç›®ç»“æ„

```
publish-moments/
â”œâ”€â”€ index.html          # ä¸»é¡µé¢æ–‡ä»¶
â”œâ”€â”€ README.md           # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â””â”€â”€ package.json        # é¡¹ç›®é…ç½®æ–‡ä»¶
```

## ğŸ”§ æ ¸å¿ƒä»£ç 

### HTMLç»“æ„

```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Excelå›¾ç‰‡å¤„ç†å·¥å…·</title>
  <script src="https://cdn.jsdelivr.net/npm/excelize-wasm@0.0.9/index.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .container {
      background: white;
      border-radius: 20px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
      padding: 40px;
      max-width: 800px;
      width: 100%;
    }

    .header {
      text-align: center;
      margin-bottom: 30px;
    }

    .header h1 {
      color: #333;
      font-size: 2.5em;
      margin-bottom: 10px;
      font-weight: 700;
    }

    .header p {
      color: #666;
      font-size: 1.1em;
    }

    .upload-area {
      border: 3px dashed #ddd;
      border-radius: 15px;
      padding: 40px;
      text-align: center;
      margin-bottom: 30px;
      transition: all 0.3s ease;
      cursor: pointer;
      position: relative;
    }

    .upload-area:hover {
      border-color: #667eea;
      background-color: #f8f9ff;
    }

    .upload-area.dragover {
      border-color: #667eea;
      background-color: #f0f4ff;
    }

    .upload-icon {
      font-size: 3em;
      color: #667eea;
      margin-bottom: 15px;
    }

    .upload-text {
      font-size: 1.2em;
      color: #333;
      margin-bottom: 10px;
    }

    .upload-hint {
      color: #999;
      font-size: 0.9em;
    }

    #file-input {
      position: absolute;
      opacity: 0;
      width: 100%;
      height: 100%;
      cursor: pointer;
    }

    .progress-container {
      display: none;
      margin: 20px 0;
    }

    .progress-bar {
      width: 100%;
      height: 8px;
      background-color: #f0f0f0;
      border-radius: 4px;
      overflow: hidden;
      margin-bottom: 10px;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #667eea, #764ba2);
      width: 0%;
      transition: width 0.3s ease;
    }

    .progress-text {
      text-align: center;
      color: #666;
      font-size: 0.9em;
    }

    .status-container {
      margin: 20px 0;
      padding: 20px;
      border-radius: 10px;
      background-color: #f8f9fa;
      display: none;
    }

    .status-item {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
      padding: 10px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }

    .status-icon {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      margin-right: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      color: white;
    }

    .status-icon.success {
      background-color: #28a745;
    }

    .status-icon.processing {
      background-color: #ffc107;
      animation: pulse 1.5s infinite;
    }

    .status-icon.error {
      background-color: #dc3545;
    }

    @keyframes pulse {
      0% {
        opacity: 1;
      }

      50% {
        opacity: 0.5;
      }

      100% {
        opacity: 1;
      }
    }

    .status-text {
      flex: 1;
      color: #333;
    }

    .download-btn {
      display: none;
      width: 100%;
      padding: 15px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 1.1em;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-top: 20px;
    }

    .download-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
    }

    .download-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    .error-message {
      color: #dc3545;
      background-color: #f8d7da;
      border: 1px solid #f5c6cb;
      border-radius: 8px;
      padding: 15px;
      margin: 20px 0;
      display: none;
    }

    .success-message {
      color: #155724;
      background-color: #d4edda;
      border: 1px solid #c3e6cb;
      border-radius: 8px;
      padding: 15px;
      margin: 20px 0;
      display: none;
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>ğŸ“Š Excelå›¾ç‰‡å¤„ç†å·¥å…·</h1>
      <p>ä¸Šä¼ Excelæ–‡ä»¶ï¼Œè‡ªåŠ¨å¤„ç†å›¾ç‰‡å¹¶è®¾ç½®è¶…é“¾æ¥</p>
    </div>

    <div class="upload-area" id="upload-area">
      <div class="upload-icon">ğŸ“</div>
      <div class="upload-text">ç‚¹å‡»æˆ–æ‹–æ‹½Excelæ–‡ä»¶åˆ°æ­¤å¤„</div>
      <div class="upload-hint">æ”¯æŒ .xlsx, .xls æ ¼å¼</div>
      <input type="file" id="file-input" accept=".xlsx,.xls" />
    </div>

    <div class="progress-container" id="progress-container">
      <div class="progress-bar">
        <div class="progress-fill" id="progress-fill"></div>
      </div>
      <div class="progress-text" id="progress-text">å‡†å¤‡å¤„ç†...</div>
    </div>

    <div class="status-container" id="status-container">
      <div class="status-item">
        <div class="status-icon processing" id="status-loading">â³</div>
        <div class="status-text" id="status-loading-text">æ­£åœ¨åŠ è½½Excelæ–‡ä»¶...</div>
      </div>
      <div class="status-item">
        <div class="status-icon" id="status-pictures">â³</div>
        <div class="status-text" id="status-pictures-text">æ­£åœ¨è·å–å›¾ç‰‡ä¿¡æ¯...</div>
      </div>
      <div class="status-item">
        <div class="status-icon" id="status-upload">â³</div>
        <div class="status-text" id="status-upload-text">æ­£åœ¨ä¸Šä¼ å›¾ç‰‡...</div>
      </div>
      <div class="status-item">
        <div class="status-icon" id="status-links">â³</div>
        <div class="status-text" id="status-links-text">æ­£åœ¨è®¾ç½®è¶…é“¾æ¥...</div>
      </div>
      <div class="status-item">
        <div class="status-icon" id="status-save">â³</div>
        <div class="status-text" id="status-save-text">æ­£åœ¨ä¿å­˜æ–‡ä»¶...</div>
      </div>
    </div>

    <div class="error-message" id="error-message"></div>
    <div class="success-message" id="success-message"></div>

    <button class="download-btn" id="download-btn" disabled>
      ğŸ“¥ ä¸‹è½½å¤„ç†åçš„Excelæ–‡ä»¶
    </button>
  </div>

  <script type="module">
    let excelize = null;
    let processedFile = null;

    // åˆå§‹åŒ–excelize
    async function initExcelize() {
      try {
        excelize = await excelizeWASM.init(
          "https://cdn.jsdelivr.net/npm/excelize-wasm@0.0.9/excelize.wasm.gz"
        );
        console.log("Excelize initialized successfully");
      } catch (error) {
        console.error("Failed to initialize Excelize:", error);
        showError("åˆå§‹åŒ–Excelizeå¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•");
      }
    }

    // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
    function showError(message) {
      const errorElement = document.getElementById('error-message');
      errorElement.textContent = message;
      errorElement.style.display = 'block';
      document.getElementById('success-message').style.display = 'none';
    }

    // æ˜¾ç¤ºæˆåŠŸä¿¡æ¯
    function showSuccess(message) {
      const successElement = document.getElementById('success-message');
      successElement.textContent = message;
      successElement.style.display = 'block';
      document.getElementById('error-message').style.display = 'none';
    }

    // æ›´æ–°è¿›åº¦æ¡
    function updateProgress(percentage, text) {
      document.getElementById('progress-fill').style.width = percentage + '%';
      document.getElementById('progress-text').textContent = text;
    }

    // æ›´æ–°çŠ¶æ€
    function updateStatus(statusId, type, text) {
      const statusElement = document.getElementById(statusId).parentElement;
      const iconElement = statusElement.querySelector('.status-icon');
      const textElement = statusElement.querySelector('.status-text');

      iconElement.className = `status-icon ${type}`;
      textElement.textContent = text;

      if (type === 'success') {
        iconElement.textContent = 'âœ“';
      } else if (type === 'error') {
        iconElement.textContent = 'âœ—';
      } else if (type === 'processing') {
        iconElement.textContent = 'â³';
      }
    }

    // æ¨¡æ‹Ÿå¼‚æ­¥ä¸Šä¼ 
    async function simulateUpload(fileData, extension) {
      return new Promise((resolve) => {
        setTimeout(() => {
          // æ¨¡æ‹Ÿä¸Šä¼ æˆåŠŸï¼Œè¿”å›ä¸€ä¸ªæ¨¡æ‹Ÿçš„URL
          const mockUrl = `https://example.com/uploads/${Date.now()}${extension}`;
          resolve(mockUrl);
        }, 1000);
      });
    }

    // å¤„ç†Excelæ–‡ä»¶
    async function processExcelFile(file) {
      try {
        // æ˜¾ç¤ºè¿›åº¦å®¹å™¨
        document.getElementById('progress-container').style.display = 'block';
        document.getElementById('status-container').style.display = 'block';
        document.getElementById('download-btn').style.display = 'none';

        updateProgress(10, 'æ­£åœ¨è¯»å–æ–‡ä»¶...');
        updateStatus('status-loading', 'processing', 'æ­£åœ¨åŠ è½½Excelæ–‡ä»¶...');

        // è¯»å–æ–‡ä»¶
        const arrayBuffer = await file.arrayBuffer();
        const byteArray = new Uint8Array(arrayBuffer);

        updateProgress(20, 'æ­£åœ¨è§£æExcel...');
        updateStatus('status-loading', 'success', 'Excelæ–‡ä»¶åŠ è½½æˆåŠŸ');

        // æ‰“å¼€Excelæ–‡ä»¶
        const f = excelize.OpenReader(byteArray);
        console.log('f', f);

        updateProgress(30, 'æ­£åœ¨è·å–å›¾ç‰‡ä¿¡æ¯...');
        updateStatus('status-pictures', 'processing', 'æ­£åœ¨è·å–å›¾ç‰‡ä¿¡æ¯...');

        // è·å–æ‰€æœ‰åŒ…å«å›¾ç‰‡çš„å•å…ƒæ ¼
        const pictureCells = f.GetPictureCells("Sheet1")?.cells;
        console.log('Picture cells:', pictureCells);

        if (!pictureCells || pictureCells.length === 0) {
          updateStatus('status-pictures', 'success', 'æœªå‘ç°å›¾ç‰‡ï¼Œè·³è¿‡å›¾ç‰‡å¤„ç†');
          updateStatus('status-upload', 'success', 'æ— éœ€ä¸Šä¼ å›¾ç‰‡');
          updateStatus('status-links', 'success', 'æ— éœ€è®¾ç½®è¶…é“¾æ¥');
          updateProgress(90, 'æ­£åœ¨ä¿å­˜æ–‡ä»¶...');
          updateStatus('status-save', 'processing', 'æ­£åœ¨ä¿å­˜æ–‡ä»¶...');

          // ç›´æ¥ä¿å­˜æ–‡ä»¶
          const output = f.WriteToBuffer();
          processedFile = new Blob([output], {
            type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'
          });

          updateProgress(100, 'å¤„ç†å®Œæˆï¼');
          updateStatus('status-save', 'success', 'æ–‡ä»¶ä¿å­˜æˆåŠŸ');
          document.getElementById('download-btn').disabled = false;
          showSuccess('æ–‡ä»¶å¤„ç†å®Œæˆï¼æœªå‘ç°å›¾ç‰‡ï¼Œå·²ä¿å­˜åŸæ–‡ä»¶ã€‚');
          return;
        }

        updateStatus('status-pictures', 'success', `å‘ç° ${pictureCells.length} ä¸ªå›¾ç‰‡å•å…ƒæ ¼`);
        updateProgress(40, 'æ­£åœ¨å¤„ç†å›¾ç‰‡...');
        updateStatus('status-upload', 'processing', 'æ­£åœ¨ä¸Šä¼ å›¾ç‰‡...');

        // å¤„ç†æ¯ä¸ªå›¾ç‰‡
        const uploadPromises = [];
        for (let i = 0; i < pictureCells.length; i++) {
          const cell = pictureCells[i];
          const pictures = f.GetPictures("Sheet1", cell);

          if (pictures && pictures.pictures && pictures.pictures.length > 0) {
            for (const picture of pictures.pictures) {
              const uploadPromise = simulateUpload(picture.File, picture.Extension)
                .then(url => ({ cell, url }));
              uploadPromises.push(uploadPromise);
            }
          }
        }
        console.log('uploadPromises', uploadPromises);

        // ç­‰å¾…æ‰€æœ‰ä¸Šä¼ å®Œæˆ
        const uploadResults = await Promise.all(uploadPromises);
        updateStatus('status-upload', 'success', `æˆåŠŸä¸Šä¼  ${uploadResults.length} ä¸ªå›¾ç‰‡`);
        updateProgress(60, 'æ­£åœ¨è®¾ç½®è¶…é“¾æ¥...');
        updateStatus('status-links', 'processing', 'æ­£åœ¨è®¾ç½®è¶…é“¾æ¥...');
        console.log('uploadResults', uploadResults);

        // æŒ‰å•å…ƒæ ¼åˆ†ç»„ï¼Œå¤„ç†åŒä¸€ä¸ªå•å…ƒæ ¼çš„å¤šä¸ªå›¾ç‰‡
        const cellGroups = {};
        for (const result of uploadResults) {
          if (!cellGroups[result.cell]) {
            cellGroups[result.cell] = [];
          }
          cellGroups[result.cell].push(result.url);
        }
        const style = f.NewStyle({
          Alignment: {
            WrapText: true,
          }
        });

        // è®¾ç½®è¶…é“¾æ¥
        for (const [cell, urls] of Object.entries(cellGroups)) {
          // åˆ é™¤å›¾ç‰‡
          f.DeletePicture("Sheet1", cell);

          f.SetCellStyle("Sheet1", cell, cell, style?.style);
          // è®¾ç½®å•å…ƒæ ¼å€¼ - å¤šä¸ªURLç”¨æ¢è¡Œç¬¦æ‹¼æ¥
          const cellText = urls.join('\n\n');
          f.SetCellValue("Sheet1", cell, cellText);
          // è®¾ç½®è¶…é“¾æ¥
          // f.SetCellHyperLink("Sheet1", cell, urls[0], "External", {
          //   Display: cellText,
          //   Tooltip: cellText,
          // });
        }

        updateStatus('status-links', 'success', `æˆåŠŸè®¾ç½® ${uploadResults.length} ä¸ªè¶…é“¾æ¥`);
        updateProgress(80, 'æ­£åœ¨ä¿å­˜æ–‡ä»¶...');
        updateStatus('status-save', 'processing', 'æ­£åœ¨ä¿å­˜æ–‡ä»¶...');

        // ä¿å­˜æ–‡ä»¶
        const output = f.WriteToBuffer();
        console.log('output', output);
        if (output.buffer) {
          processedFile = new Blob([output.buffer], {
            type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'
          });
        }

        updateProgress(100, 'å¤„ç†å®Œæˆï¼');
        updateStatus('status-save', 'success', 'æ–‡ä»¶ä¿å­˜æˆåŠŸ');
        document.getElementById('download-btn').disabled = false;
        document.getElementById('download-btn').style.display = 'block';
        showSuccess(`å¤„ç†å®Œæˆï¼å…±å¤„ç† ${uploadResults.length} ä¸ªå›¾ç‰‡ï¼Œå·²è®¾ç½®è¶…é“¾æ¥ã€‚`);

      } catch (error) {
        console.error('å¤„ç†Excelæ–‡ä»¶æ—¶å‡ºé”™:', error);
        showError(`å¤„ç†æ–‡ä»¶æ—¶å‡ºé”™: ${error.message}`);
        updateProgress(0, 'å¤„ç†å¤±è´¥');
      }
    }

    // ä¸‹è½½å¤„ç†åçš„æ–‡ä»¶
    function downloadProcessedFile() {
      if (!processedFile) {
        showError('æ²¡æœ‰å¯ä¸‹è½½çš„æ–‡ä»¶');
        return;
      }

      const url = URL.createObjectURL(processedFile);
      const link = document.createElement('a');
      link.href = url;
      link.download = `processed_${new Date().getTime()}.xlsx`;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(url);
    }

    // äº‹ä»¶ç›‘å¬å™¨
    document.addEventListener('DOMContentLoaded', async () => {
      await initExcelize();

      const uploadArea = document.getElementById('upload-area');
      const fileInput = document.getElementById('file-input');
      const downloadBtn = document.getElementById('download-btn');

      // æ–‡ä»¶é€‰æ‹©äº‹ä»¶
      fileInput.addEventListener('change', (e) => {
        const file = e.target.files[0];
        if (file) {
          processExcelFile(file);
        }
      });

      // æ‹–æ‹½äº‹ä»¶
      uploadArea.addEventListener('dragover', (e) => {
        e.preventDefault();
        uploadArea.classList.add('dragover');
      });

      uploadArea.addEventListener('dragleave', (e) => {
        e.preventDefault();
        uploadArea.classList.remove('dragover');
      });

      uploadArea.addEventListener('drop', (e) => {
        e.preventDefault();
        uploadArea.classList.remove('dragover');
        const file = e.dataTransfer.files[0];
        if (file && (file.name.endsWith('.xlsx') || file.name.endsWith('.xls'))) {
          processExcelFile(file);
        } else {
          showError('è¯·é€‰æ‹©æœ‰æ•ˆçš„Excelæ–‡ä»¶ (.xlsx æˆ– .xls)');
        }
      });

      // ç‚¹å‡»ä¸Šä¼ åŒºåŸŸ
      uploadArea.addEventListener('click', () => {
        fileInput.click();
      });

      // ä¸‹è½½æŒ‰é’®
      downloadBtn.addEventListener('click', downloadProcessedFile);
    });
  </script>
</body>
</html>
```

## ğŸ” æ ¸å¿ƒåŠŸèƒ½è§£æ

### 1. Excelæ–‡ä»¶å¤„ç†
- ä½¿ç”¨excelize-wasmåº“è¯»å–å’Œæ“ä½œExcelæ–‡ä»¶
- æ”¯æŒ.xlsxå’Œ.xlsæ ¼å¼
- è‡ªåŠ¨è¯†åˆ«åŒ…å«å›¾ç‰‡çš„å•å…ƒæ ¼

### 2. å›¾ç‰‡æå–ä¸ä¸Šä¼ 
- ä»Excelä¸­æå–å›¾ç‰‡æ•°æ®
- æ¨¡æ‹Ÿå¼‚æ­¥ä¸Šä¼ è¿‡ç¨‹ï¼ˆå¯æ›¿æ¢ä¸ºçœŸå®ä¸Šä¼ é€»è¾‘ï¼‰
- æ”¯æŒæ‰¹é‡å¤„ç†å¤šä¸ªå›¾ç‰‡

### 3. è¶…é“¾æ¥è®¾ç½®
- åˆ é™¤åŸå›¾ç‰‡
- è®¾ç½®å•å…ƒæ ¼æ ·å¼ï¼ˆè‡ªåŠ¨æ¢è¡Œï¼‰
- å°†å›¾ç‰‡URLè®¾ç½®ä¸ºå•å…ƒæ ¼å†…å®¹

### 4. ç”¨æˆ·ç•Œé¢
- ç°ä»£åŒ–çš„æ¸å˜èƒŒæ™¯è®¾è®¡
- æ‹–æ‹½ä¸Šä¼ åŠŸèƒ½
- å®æ—¶è¿›åº¦æ¡å’ŒçŠ¶æ€æ˜¾ç¤º
- å“åº”å¼å¸ƒå±€

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **å‰ç«¯æ¡†æ¶**: åŸç”ŸHTML5 + CSS3 + JavaScript
- **Excelå¤„ç†**: excelize-wasm
- **æ–‡ä»¶æ“ä½œ**: File API, Blob API
- **UIè®¾è®¡**: CSS Grid, Flexbox, æ¸å˜æ•ˆæœ

## ğŸ“ ä½¿ç”¨è¯´æ˜

1. **ç¯å¢ƒè¦æ±‚**: ç°ä»£æµè§ˆå™¨ï¼ˆæ”¯æŒES6+ï¼‰
2. **æ–‡ä»¶æ ¼å¼**: æ”¯æŒ.xlsxå’Œ.xlsæ ¼å¼çš„Excelæ–‡ä»¶
3. **å›¾ç‰‡å¤„ç†**: è‡ªåŠ¨è¯†åˆ«Sheet1ä¸­çš„å›¾ç‰‡
4. **è¾“å‡ºæ ¼å¼**: å¤„ç†åçš„æ–‡ä»¶ä¸º.xlsxæ ¼å¼

## ğŸ”§ è‡ªå®šä¹‰é…ç½®

### ä¿®æ”¹ä¸Šä¼ é€»è¾‘
å°†`simulateUpload`å‡½æ•°æ›¿æ¢ä¸ºçœŸå®çš„ä¸Šä¼ APIè°ƒç”¨ï¼š

```javascript
async function realUpload(fileData, extension) {
  const formData = new FormData();
  formData.append('file', new Blob([fileData]));
  
  const response = await fetch('/api/upload', {
    method: 'POST',
    body: formData
  });
  
  const result = await response.json();
  return result.url;
}
```

### ä¿®æ”¹å·¥ä½œè¡¨åç§°
å°†ä»£ç ä¸­çš„"Sheet1"æ›¿æ¢ä¸ºå®é™…çš„å·¥ä½œè¡¨åç§°ï¼š

```javascript
const pictureCells = f.GetPictureCells("YourSheetName")?.cells;
```

## ğŸš¨ æ³¨æ„äº‹é¡¹

1. **æ–‡ä»¶å¤§å°**: å¤§æ–‡ä»¶å¤„ç†å¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´
2. **æµè§ˆå™¨å…¼å®¹æ€§**: éœ€è¦æ”¯æŒWebAssemblyçš„ç°ä»£æµè§ˆå™¨
3. **ç½‘ç»œè¿æ¥**: ä¸Šä¼ åŠŸèƒ½éœ€è¦ç½‘ç»œè¿æ¥ï¼ˆå½“å‰ä¸ºæ¨¡æ‹Ÿï¼‰
4. **å†…å­˜ä½¿ç”¨**: å¤§æ–‡ä»¶å¯èƒ½å ç”¨è¾ƒå¤šå†…å­˜


