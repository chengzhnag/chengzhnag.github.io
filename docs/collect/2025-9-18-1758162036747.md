---
title: React + Vite å‰ç«¯é¡¹ç›®å¦‚ä½•æ··åˆå¼€å‘æ„å»ºAPP
date: 2025-9-18
categories:

tags:
 - Capacitor
---

**ä¸“ä¸º H5 ä¸åŸç”Ÿé€šä¿¡è®¾è®¡çš„æ··åˆå¼€å‘æ¡†æ¶**ï¼Œå·²ç»å¸®ä½ å°è£…å¥½äº†å®‰å“èƒ½åŠ›è°ƒç”¨ï¼Œåªéœ€å‡ è¡Œ JavaScript å°±èƒ½æ‹ç…§ã€è·å–å®šä½ã€è¯»å–é€šè®¯å½•ç­‰ã€‚

---

## âœ… æœ€ä½³æ¨èï¼š**Capacitor**ï¼ˆç”± Ionic å›¢é˜Ÿå¼€å‘ï¼‰

> **å®˜ç½‘**ï¼š[https://capacitorjs.com](https://capacitorjs.com)

### ğŸ”¥ ä¸ºä»€ä¹ˆæ¨è Capacitorï¼Ÿ

- **ä¸“ä¸º Web + åŸç”Ÿæ··åˆå¼€å‘è®¾è®¡**ï¼Œå®Œç¾é€‚é…ä½ ç°æœ‰çš„ **React + Vite é¡¹ç›®**ã€‚
- **å¼€ç®±å³ç”¨çš„åŸç”Ÿ API**ï¼šç›¸æœºã€GPSã€é€šçŸ¥ã€æ–‡ä»¶ç³»ç»Ÿç­‰ï¼Œå…¨éƒ¨å°è£…æˆ JS æ¥å£ã€‚
- **æ”¯æŒ TypeScript**ï¼Œç±»å‹æç¤ºæ¸…æ™°ï¼Œå¼€å‘ä½“éªŒæä½³ã€‚
- **è·¨å¹³å°**ï¼šä¸€å¥—ä»£ç ï¼ŒåŒæ—¶ç”Ÿæˆå®‰å“å’Œ iOS åº”ç”¨ã€‚
- **å¯ä¸ React/Vue/Angular æ— ç¼é›†æˆ**ã€‚

---

### âœ… ä½¿ç”¨ Capacitor çš„ 5 ä¸ªæ­¥éª¤

#### 1. åœ¨ä½ çš„ React + Vite é¡¹ç›®ä¸­å®‰è£… Capacitor

```bash
npm install @capacitor/core @capacitor/cli
```

#### 2. åˆå§‹åŒ– Capacitor

```bash
npx cap init
```

ä¼šæç¤ºä½ è¾“å…¥ï¼š
- App åç§°ï¼ˆå¦‚ `MyApp`ï¼‰
- App IDï¼ˆå¦‚ `com.example.myapp`ï¼‰
- ç½‘é¡µå…¥å£ï¼ˆé»˜è®¤ `dist` æˆ– `build`ï¼‰

#### 3. å®‰è£…å®‰å“å¹³å°æ”¯æŒ

```bash
npm install @capacitor/android
npx cap add android
```

è¿™ä¼šç”Ÿæˆä¸€ä¸ªåŸç”Ÿå®‰å“é¡¹ç›®ï¼š`android/`

#### 4. æ„å»ºä½ çš„ React é¡¹ç›®å¹¶åŒæ­¥åˆ°å®‰å“

```bash
# å…ˆæ‰“åŒ…ä½ çš„ Vite é¡¹ç›®
npm run build

# å°†æ„å»ºç»“æœåŒæ­¥åˆ°å®‰å“é¡¹ç›®
npx cap copy
```

> Capacitor ä¼šè‡ªåŠ¨æŠŠ `dist/` æ–‡ä»¶å¤åˆ¶åˆ°å®‰å“é¡¹ç›®çš„ assets ä¸­ã€‚

#### 5. æ‰“å¼€å®‰å“é¡¹ç›®ï¼ˆå¯é€‰ï¼‰

```bash
npx cap open android
```

è¿™ä¼šç”¨ Android Studio æ‰“å¼€é¡¹ç›®ï¼Œä½ å¯ä»¥ç¼–è¯‘ã€è¿è¡Œã€è°ƒè¯•ã€‚

---

### âœ… å¦‚ä½•è°ƒç”¨å®‰å“åŸç”Ÿèƒ½åŠ›ï¼Ÿï¼ˆç¤ºä¾‹ï¼‰

Capacitor æä¾›äº†ç»Ÿä¸€çš„ JS APIï¼Œç›´æ¥è°ƒç”¨å³å¯ï¼š

#### ğŸ“¸ æ‹ç…§

```js
import { Camera, CameraResultType } from '@capacitor/camera';

const takePicture = async () => {
  const image = await Camera.getPhoto({
    quality: 90,
    allowEditing: true,
    resultType: CameraResultType.Uri, // æˆ– base64
  });

  // image.webPath æ˜¯å›¾ç‰‡è·¯å¾„ï¼Œå¯ç”¨äº <img> æ˜¾ç¤º
  console.log(image.webPath);
};
```

#### ğŸ“ è·å–å®šä½

```js
import { Geolocation } from '@capacitor/geolocation';

const getLocation = async () => {
  const position = await Geolocation.getCurrentPosition();
  console.log(position.coords.latitude, position.coords.longitude);
};
```

#### ğŸ”” å‘é€é€šçŸ¥

```js
import { LocalNotifications } from '@capacitor/local-notifications';

await LocalNotifications.requestPermissions();
await LocalNotifications.schedule({
  notifications: [
    {
      title: "æé†’",
      body: "è¯¥å–æ°´äº†ï¼",
      id: 1,
      schedule: { at: new Date(Date.now() + 1000 * 5) },
    },
  ],
});
```

#### ğŸ“± å…¶ä»–èƒ½åŠ›
- æ–‡ä»¶ç³»ç»Ÿï¼ˆ`@capacitor/filesystem`ï¼‰
- ç”µæ± çŠ¶æ€ï¼ˆ`@capacitor/battery`ï¼‰
- ç½‘ç»œçŠ¶æ€ï¼ˆ`@capacitor/network`ï¼‰
- ä¼ æ„Ÿå™¨ï¼ˆé™€èºä»ªã€åŠ é€Ÿåº¦è®¡ï¼‰

---

### âœ… H5 ä¸åŸç”Ÿé€šä¿¡ï¼ˆåŒå‘ï¼‰

#### 1. H5 è°ƒç”¨åŸç”Ÿï¼šç›´æ¥è°ƒç”¨ Capacitor APIï¼ˆå¦‚ä¸Šæ‰€ç¤ºï¼‰

#### 2. åŸç”Ÿè°ƒç”¨ H5ï¼ˆç›‘å¬äº‹ä»¶ï¼‰

```js
// åœ¨ H5 ä¸­ç›‘å¬åŸç”Ÿäº‹ä»¶
import { App } from '@capacitor/app';

App.addListener('appUrlOpen', (data) => {
  console.log('å¤–éƒ¨é“¾æ¥æ‰“å¼€:', data.url);
});
```

---

## ğŸ†š å¯¹æ¯”å…¶ä»–æ–¹æ¡ˆ

| æ–¹æ¡ˆ | ä¼˜ç‚¹ | ç¼ºç‚¹ |
|------|------|------|
| **Capacitor** âœ… | ä¸“ä¸º Web è®¾è®¡ï¼ŒAPI ä¸°å¯Œï¼ŒReact å‹å¥½ | éœ€è¦å­¦ä¹ ç®€å•é…ç½® |
| Cordova / PhoneGap | è€ç‰Œæ¡†æ¶ï¼Œæ’ä»¶å¤š | å·²è¿‡æ—¶ï¼Œç»´æŠ¤å°‘ |
| React Native + WebView | çµæ´»ï¼Œå¯æ··åˆå¼€å‘ | éœ€æ‰‹åŠ¨å°è£…åŸç”ŸåŠŸèƒ½ |
| Flutter + WebView | æ€§èƒ½å¥½ | éœ€å­¦ Dartï¼ŒH5 é€šä¿¡å¤æ‚ |

> ğŸ’¡ **ç»“è®ºï¼šCapacitor æ˜¯ç›®å‰æœ€é€‚åˆä½ éœ€æ±‚çš„æ–¹æ¡ˆ**ã€‚

---

## âœ… æ€»ç»“ï¼šä¸ºä»€ä¹ˆé€‰ Capacitorï¼Ÿ

| éœ€æ±‚ | Capacitor æ˜¯å¦æ»¡è¶³ |
|------|------------------|
| ç°æœ‰ React + Vite é¡¹ç›® | âœ… ç›´æ¥é›†æˆ |
| è°ƒç”¨å®‰å“ç›¸æœºã€GPSã€é€šçŸ¥ç­‰ | âœ… å¼€ç®±å³ç”¨ |
| æ— éœ€å†™åŸç”Ÿä»£ç  | âœ… JS/TS ç›´æ¥è°ƒç”¨ |
| è·¨å¹³å°ï¼ˆå®‰å“ + iOSï¼‰ | âœ… æ”¯æŒ |
| å…è´¹ã€å¼€æºã€æ´»è·ƒç»´æŠ¤ | âœ… Ionic å›¢é˜Ÿç»´æŠ¤ |

---

### ğŸš€ ç°åœ¨å°±å¯ä»¥å¼€å§‹

```bash
# 1. è¿›å…¥ä½ çš„ React + Vite é¡¹ç›®
cd your-vite-project

# 2. å®‰è£… Capacitor
npm install @capacitor/core @capacitor/cli

# 3. åˆå§‹åŒ–
npx cap init

# 4. æ·»åŠ å®‰å“
npm install @capacitor/android
npx cap add android

# 5. æ„å»ºå¹¶åŒæ­¥
npm run build
npx cap copy

# 6. è¿è¡Œ
npx cap open android  # ç”¨ Android Studio æ‰“å¼€å¹¶è¿è¡Œ

# 7. æ„å»ºapp
npx cap build android  # éœ€è¦æœ¬åœ°JDKæ‰èƒ½æ„å»º  
```

**å‡ åˆ†é’Ÿå†…ï¼Œä½ çš„ H5 é¡µé¢å°±èƒ½å˜æˆä¸€ä¸ªèƒ½è°ƒç”¨å®‰å“èƒ½åŠ›çš„ Appï¼** ğŸ‰
